---
layout: post
title: "스프링 개념 정리"
subtitle: ""
date: 2019-09-22 12:45:18
categories: devlog
tags: bit spring web
---

도커 기초 사용법

---

1. wget 설치
`sudo yum -y install wget`

2. tomcat 8.5 버전 다운로드
`wget https://archive.apache.org/dist/tomcat/tomcat-8/v8.5.9/bin/apache-tomcat-8.5.9.tar.gz`

3. 압축풀기
`tar xvfz apache-tomcat-8.5.9.tar.gz`

4. 새로 설치한 사람은 firewalld 깔려있는지 확인해야함.

	1. 없으면 
		```bash
		sudo yum install firewalld
		systemctl enable firewalld
		systemctl start firewalld
		```


	2. 있으면 
		```bash
		firewall-cmd --zone=public --add-port=8080/tcp --permanent
		firewall-cmd --reload
		```

- AWS는 인바운드 열어준다.

5. 도커 다운
```bash
sudo yum -y install docker docker-registry
```

6. root 권한으로 접속
```bash
sudo su
```

7. 도커 실행
```bash
systemctl start docker
```

8. 도커 이미지 받음 - 오피셜 이미지로 받는 것
```bash
docker pull tomcat
```

9. 도커 이미지 확인 명령어
```bash
docker images
```

10. 도커 컨테이너 세팅
```bash
docker run -d -p 8888:8080 --name ${name} ${container id}
```

11. 도커 컨테이너 보기
    1. 현재 실행되고 있는 컨테이너만 보여줌
    ```bash
    docker ps 
    ```

    2. 현재 실행 & 중지되어 있는 모든 컨테이너 보여줌
    ```bash
    docker ps -a
    ```

12. 해당 8888포트로 들어가면 톰캣실행된걸 알 수 있음.
```bash
http://192.168.137.129:8888/
```

----------------------------
13. docker에 tomcat war2 파일 복사  
(`ad`는 도커 컨테이너 id 앞 두자리이다)
```bash
docker cp ./war2.war ${container id}:/usr/local/tomcat/webapps/
```
-----------------------------

14. tomcat 컨테이너 안으로 들어가는 것 확인
```bash
docker exec -it ${container id} /bin/bash
```

15. 웹 상으로 접속 확인
```
http://192.168.137.129:8888/war2/
```

-------------
16. docker hub 로그인 하기
```bash
docker login
```

17-1. docker hub에 업로드 하기위한 이미지화  
(-a 는 author의 약자)
```bash
docker commit -a "${docker writer}" -m "${commit message}" ${container id} ${dockerhub id}/${repository name}:${version}
```
밑에 sha256 뜨면 완료.

17-2.
```bash
docker images
```
로 만들어진것 확인.

18. 도커 push
```bash
docker push ${dockerhub id}/${repository name}:${version}
```

##### 도커 이미지 받기
1. 도커 pull
```bash
docker pull ${dockerhub id}/${repository name}:${version}
```

2. 도커 실행
```bash
docker run -d -p ${external port}:${internal port} --name ${setting container name} ${image id}
```

3. 접속하여 확인

**[번외]**  
- 남의 것 받기  
    (남의 도커 주소 받으면 바로 서비스 할 수 있다. 아래 문구는 은우행님)
    ```bash
    docker pull sadb0101/wartest:0.1
    ```

- 특정 버전을 pull 받고싶으면  
```bash
docker pull tomcat : ${공홈 프로그램 tag에 있는 이미지 이름}
```

- `docker run`  
docker start와 create를 합친 명령어

- 각 image의 포트 여는것들은 공홈에서 imageid를 클릭하고 `Expose`라 적혀있는 command 보면 된다.

- **도커 log**
	diff ${container id}
	a 추가 , c: 변경, d: 삭제